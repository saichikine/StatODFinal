function [A] = A(x, y, z, params)

%A = dF/dX, where F = dX/dt, and X = [r v]^T
%so, F = dX/dt = [xdot ydot zdot xddot yddot zddot]^T
%and A = dF/dX = [
%so, A looks like:
%A =  |0    I|
%     |Udd  O|

A = zeros(6,6);

mu = params(1);
J2 = params(2);
R = params(3);
J3 = params(4);

A(1,4) = 1;
A(2,5) = 1;
A(3,6) = 1;

A(4:6,1:3) = [(1/2).*(x.^2+y.^2+z.^2).^(-11/2).*(2.*(2.*x.^2+(-1).*y.^2).*( ...
x.^2+y.^2).^3+15.*J3.*R.^3.*(6.*x.^2+(-1).*y.^2).*(x.^2+y.^2).*z+ ...
  2.*(5.*x.^2+(-4).*y.^2).*(x.^2+y.^2).^2.*z.^2+5.*J3.*R.^3.*((-41) ...
  .*x.^2+y.^2).*z.^3+6.*(x.^2+(-2).*y.^2).*(x.^2+y.^2).*z.^4+20.* ...
  J3.*R.^3.*z.^5+(-2).*(x.^2+4.*y.^2).*z.^6+(-2).*z.^8+3.*J2.*R.^2.* ...
  (x.^2+y.^2+z.^2).*(4.*x.^4+(-1).*y.^4+3.*y.^2.*z.^2+4.*z.^4+3.* ...
  x.^2.*(y.^2+(-9).*z.^2))).*mu,(3/2).*x.*y.*(x.^2+y.^2+z.^2).^( ...
  -11/2).*(2.*(x.^2+y.^2).^3+35.*J3.*R.^3.*(x.^2+y.^2).*z+6.*(x.^2+ ...
  y.^2).^2.*z.^2+(-70).*J3.*R.^3.*z.^3+6.*(x.^2+y.^2).*z.^4+2.*z.^6+ ...
  5.*J2.*R.^2.*(x.^2+y.^2+(-6).*z.^2).*(x.^2+y.^2+z.^2)).*mu, (3/2).* ...
  x.*(x.^2+y.^2+z.^2).^(-11/2).*((-5).*J3.*R.^3.*((x.^2+y.^2).^2+( ...
-12).*(x.^2+y.^2).*z.^2+8.*z.^4)+z.*(x.^2+y.^2+z.^2).*(5.*J2.* ...
R.^2.*(3.*(x.^2+y.^2)+(-4).*z.^2)+2.*(x.^2+y.^2+z.^2).^2)).*mu;( ...
  3/2).*x.*y.*(x.^2+y.^2+z.^2).^(-11/2).*(2.*(x.^2+y.^2).^3+35.*J3.* ...
  R.^3.*(x.^2+y.^2).*z+6.*(x.^2+y.^2).^2.*z.^2+(-70).*J3.*R.^3.* ...
 z.^3+6.*(x.^2+y.^2).*z.^4+2.*z.^6+5.*J2.*R.^2.*(x.^2+y.^2+(-6).* ...
  z.^2).*(x.^2+y.^2+z.^2)).*mu, (1/2).*(x.^2+y.^2+z.^2).^(-11/2).*((...
  -2).*(x.^2+(-2).*y.^2).*(x.^2+y.^2).^3+(-15).*J3.*R.^3.*(x.^2+(-6) ...
.*y.^2).*(x.^2+y.^2).*z+(-2).*(4.*x.^2+(-5).*y.^2).*(x.^2+y.^2) ...
.^2.*z.^2+5.*J3.*R.^3.*(x.^2+(-41).*y.^2).*z.^3+6.*((-2).*x.^4+( ...
 -1).*x.^2.*y.^2+y.^4).*z.^4+20.*J3.*R.^3.*z.^5+(-2).*(4.*x.^2+ ...
y.^2).*z.^6+(-2).*z.^8+(-3).*J2.*R.^2.*(x.^2+y.^2+z.^2).*(x.^4+( ...
 -4).*y.^4+27.*y.^2.*z.^2+(-4).*z.^4+(-3).*x.^2.*(y.^2+z.^2))).*mu,( ...
  3/2).*y.*(x.^2+y.^2+z.^2).^(-11/2).*((-5).*J3.*R.^3.*((x.^2+y.^2) ...
.^2+(-12).*(x.^2+y.^2).*z.^2+8.*z.^4)+z.*(x.^2+y.^2+z.^2).*(5.* ...
J2.*R.^2.*(3.*(x.^2+y.^2)+(-4).*z.^2)+2.*(x.^2+y.^2+z.^2).^2)).*mu; ...
  (3/2).*x.*(x.^2+y.^2+z.^2).^(-11/2).*((-5).*J3.*R.^3.*((x.^2+y.^2) ...
.^2+(-12).*(x.^2+y.^2).*z.^2+8.*z.^4)+z.*(x.^2+y.^2+z.^2).*(5.* ...
J2.*R.^2.*(3.*(x.^2+y.^2)+(-4).*z.^2)+2.*(x.^2+y.^2+z.^2).^2)).*mu, ...
  (3/2).*y.*(x.^2+y.^2+z.^2).^(-11/2).*((-5).*J3.*R.^3.*((x.^2+y.^2) ...
.^2+(-12).*(x.^2+y.^2).*z.^2+8.*z.^4)+z.*(x.^2+y.^2+z.^2).*(5.* ...
J2.*R.^2.*(3.*(x.^2+y.^2)+(-4).*z.^2)+2.*(x.^2+y.^2+z.^2).^2)).*mu, ...
  (-1/2).*(x.^2+y.^2+z.^2).^(-11/2).*((x.^2+y.^2).^3.*(9.*J2.*R.^2+ ...
  2.*(x.^2+y.^2))+75.*J3.*R.^3.*(x.^2+y.^2).^2.*z+(x.^2+y.^2).^2.*(( ...
-63).*J2.*R.^2+2.*(x.^2+y.^2)).*z.^2+(-200).*J3.*R.^3.*(x.^2+y.^2) ...
  .*z.^3+(-6).*(x.^2+y.^2).*(8.*J2.*R.^2+x.^2+y.^2).*z.^4+40.*J3.* ...
  R.^3.*z.^5+2.*(12.*J2.*R.^2+(-5).*(x.^2+y.^2)).*z.^6+(-4).*z.^8).* ...
  mu];

end